Store = window.ObojoboDraft.Common.flux.Store
Dispatcher = window.ObojoboDraft.Common.flux.Dispatcher
FocusUtil = window.ObojoboDraft.Common.util.FocusUtil

class ScoreStore extends Store
	constructor: ->
		super('scoreStore')

		Dispatcher.on
			'score:set': (payload) =>
				@state.scores[payload.value.id] = payload.value.score

				if(payload.value.score is 100)
					FocusUtil.unfocus()

				@triggerChange()

			'score:clear': (payload) =>
				delete @state.scores[payload.value.id]
				@triggerChange()

	init: ->
		@state = {
			scores: {}
		}

	getState: -> @state

	setState: (newState) -> @state = newState

scoreStore = new ScoreStore()
module.exports = scoreStore
