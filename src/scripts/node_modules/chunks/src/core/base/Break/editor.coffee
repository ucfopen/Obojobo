Viewer = require './viewer'

ObojoboDraft = window.ObojoboDraft

Chunk = ObojoboDraft.models.Chunk


Break = React.createClass
	statics:
		type: 'ObojoboDraft.Chunks.Break'
		register: ->
			OBO.registerChunk Break, {
				insertItem:
					label: 'Break'
					icon: require 'svg-url?noquotes!./assets/insert-icon.svg'
					onInsert: (componentClass, position, referenceChunk, selection, callback) ->
						newChunk = Chunk.create componentClass
						focusChunk = null

						switch position
							when 'before'
								referenceChunk.addBefore newChunk

								if newChunk.isFirst()
									focusChunk = Chunk.create()
									newChunk.addBefore focusChunk
								else
									focusChunk = newChunk.prevSibling()

							when 'after'
								referenceChunk.addAfter newChunk

								if newChunk.isLast()
									focusChunk = Chunk.create()
									newChunk.addAfter focusChunk
								else
									focusChunk = newChunk.nextSibling()

						focusChunk.selectEnd selection

						callback()
			}
		getCommandHandler: -> null

		# OBONODE DATA METHODS
		# ================================================
		createNewNodeData: -> {}
		cloneNodeData: (data) -> {}

		# SERIALIZATION/DECODE METHODS
		# ================================================
		createNodeDataFromDescriptor: (descriptor) -> {}
		getDataDescriptor: (chunk) -> {}

	# shouldComponentUpdate: ->
	# 	@props.chunk.needsUpdate

	# componentDidUpdate: ->
	# 	@props.chunk.markUpdated()

	render: ->
		`<Viewer {...this.props} />`


module.exports = Break